This pipeline binarizes registered dendrite images and extracts a variety of morphological parameters for analysis. To use, run masterSpineAnalysis and answer questions as prompted.

Images have been previous gaussian averaged across 4 imaging planes, typically ~3 microns apart. All spines in the sequence of images are detected, and the cumulative population of spines is determined. Spine type (stubby, thin, mushroom, or filopodium) is determined by a decision tree that is highly reliant on specific morphological features, therefore if the user is imaging outside of a 16X magnification (51.8 x 51.8 micron FOV) the decision tree should be modified to accomodate these changes, or the images should be normalized to match this magnification. Otherwise, an ML approach is more appropriate. This, along with morphological feature extraction, concludes the cross-sectional spine analysis, and results are plotted.

If the user indicates that they would like to analyze a timecourse series of images from the same dendrite, the pipeline will then determine the total population of spines to calculate turnover dynamics. Boundary boxes whose centroids are > 25 pixels (~1.7 microns) apart are considered to be separate spines. Then, two 4D matrices (spine width x spine height x num days x num spines) are generated containing the whole population of spines for 1. gaussian averaged images, 2. superresolution images, and 3. binarized images. A spine detection GUI the  asks the user to go through all spines and approve their classification as "spine" or "no spine" to catch outlier cases. Output data is saved to the current directory, with changed classifications flagged. 

Estrous cycle classifications saved as a cell array of strings can be preloaded if the user indicates that they would like to analyze spine dynamics as a function of estrous cycle stage. Please refer to EstrousNet (https://github.com/ucsb-goard-lab/EstrousNet) for more information on how to reliably classify estrous stage from vaginal cytology images.
